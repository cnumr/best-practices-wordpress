[[{"l":"GenRefs, le générateur de site référentiels par Green IT."},{"l":"Objectifs et contraintes","p":["Les référentiels Green IT sont hébergés depuis 2021 sur GitHub pour laisser l'accès libre à nos travaux. GitHub, basé sur Git ajoute la possibilité de tracer les versions , les contributeurs ... et aussi de discuter sur chaques bonnes pratiques, permettant le débat et ainsi avoir une trace des échanges qui ont aboutis à un concensus.","Le format Markdown , simple, open-source et universel, est utilisé pour permettre d'avoir une bonne lisibilité des contenus structurés grâce à une mise en page, permise par le langage et bien rendu par GitHub. Mais cela reste un support de \"nerds\" :)","Lors de la création du Référentiel d'écoconception pour WordPress, nous avons décider, pour faciliter l'accès à la connaissance sur l'écoconception, de faire, en plus de ces documents Markdown, un site web plus lisible encore, et surtout utilisable pour \"Monsieur et Madame tout le monde\", qui est une des cibles de ce référentiel."]},{"l":"En résumer","p":["Objectifs","Être sur GitHub pour tracer les versions et profiter des facilités offertes ;","Rendre accessible la connaissance au plus grand nombre => Pas que du Markdown et pas que dans un repo ;","Rendre la contribution simple au moins technique => Avoir un CMS ;","Pouvoir multiplier les sites de référentiels \"simplement\".","Contraintes","Utiliser une base de fichier Markdown => Ne pas utiliser une base de données classique, donc pas un CMS classique, mais un git-cms;","Heberger les contenus sur GitHub et qu'ils restent lisible."]},{"l":"Conclusion","p":["Après plusieurs évaluations de solutions, plusieurs versions nous avons abouti à une \"stack\" qui répond à nos besoins et contraintes :","My Button"]}],[{"l":"Comment contribuer"},{"l":"Prerequis","p":["Il faut 1 compte sur le CMS, et son URL. À demander au responsable.","Lors de la première connexion, le CMS vous demandera de changer de mot de passe."]},{"l":"Navigation dans les contenus","p":["Comme les contenus des référentiels sont différents, les captures d'écran peuvent ne pas être représentatif de la réalitées.","TODO"]},{"l":"Contribution aux contenus","p":["Comme les métadatas des référentiels sont différents, les captures d'écran peuvent ne pas être représentatif de la réalitées.","TODO"]}],[{"l":"Configuration d'un Réferentiel"},{"l":"Introduction","p":["Tous les référentiels utilisent la même base technique pour simplifier et uniformiser la contribution/consultation/développement.","Tous les référentiels sont prêts à être multilingues FR, EN et ES. Pour toute autre langue, il faudra traduire l'interface."]},{"l":"Création d'un nouveau site","p":["Pour la création d'un nouveau site de référentiel, il faudra fournir toutes les informations détaillées ci-dessous au responsable."]},{"l":"Fonctionnalités proposées :","p":["Il existe 2 bases de configuration, RWEB et RWP car ils n'ont pas la même façon de gérer les métadonnées (Cycle de vie, MOE, Impacts Environnementaux, etc.) et n'ont pas les mêmes fonctionnalités."]},{"l":"Languages","p":["fr: \uD83C\uDDEB\uD83C\uDDF7 Français,","en: \uD83C\uDDEC\uD83C\uDDE7 English,","es: \uD83C\uDDEA\uD83C\uDDF8 Español,"]},{"l":"Lexique","p":["Le lexique à pour but de partager une explication de certains mots clés. Ce sont des fiches Markdown, mais affichées uniquement dans une page de liste.","Si activés :","Affichage dans la navigation de Lexique et un lien vers la page de liste ;","Possibilité de contribuer aux fiches dans le CMS.","Souhait d'évolution, que les fiches de bonnes pratiques permettent d'afficher au survol le contenu du lexique."]},{"l":"Lien vers les Personas","p":["Par défaut, il faut assigner des personas aux fiches de bonnes pratiques, mais on peut activer l'affichage d'un lien vers la page décrivant le persona. Il faut donc créer autant de personas que de langues.","Si activés :","Un lien est cliquable dans la barre des métadonées dans chaque fiche."]},{"l":"Priorité d'implémentation","p":["Obligatoire","Il y deux types d'affichages :","RWEB: Une note de 1 à 5","RWP: Une note de 1 à 3 avec des \uD83D\uDC4D"]},{"l":"Impacts environnementaux","p":["Obligatoire","Il y deux types d'affichages :","RWEB: Une note de 1 à 5","RWP: Une note de 1 à 3 avec des \uD83C\uDF31"]},{"l":"(Difficulté de) Mise en Œuvre","p":["Calcul automatisé utilisant la Priorité d'implémentation et les Impacts environnementaux si ils sont configurés pour utiliser la note de 1 à 5 (sans emoji).","Si activés :","La note MOE s'affiche dans la barre des métadonnées des fiches.","N'est pas utilisé dans RWP."]},{"l":"Lifecycle (Cycle de vie)","p":["Obligatoire","Les étapes du cycle de vie.","Specification","Concept","Development","Production","Utilization","Support","Retirement"]},{"l":"Scope (Périmètre)","p":["Cache","Comme les BP de RWP s'adressent à des publics différents, la mise en œuvre d'une bonne pratique peut se faire à des moments différents.","Documents","En contribution et en front, l'information est disponible.","Fonctionnalités","Front-office","Hébergement","Images","N'est pas utilisé dans RWEB.","Performance","Pour permètre de préciser quand réaliser la bonne pratique en plus du lifecycle.","Sécurité","SEO","Si activés :","Stockage","Thèmes","Vidéos/Audios"]},{"l":"Tiers","p":["Obligatoire","Indique les tiers impactés par la mise en œuvre de la bonne pratique.","Utilisateur/Terminal","Réseau","Datacenter"]},{"l":"Bonnes pratique RGESN","p":["Permet de lier une bonne pratique du référentiel à mettre en œuvre à une ou plusieurs critères du RGESN.","C'est un champ libre, attention à avoir une consistance dans la manière de contribuer.","Si activés :","En contribution et en front, l'information est disponible."]},{"l":"Ressources sauvegardées","p":["Obligatoire","Indique les ressources (technique, abioptique, etc.) qui seront moins impactés si la bonne pratique est mise en œuvre.","Mémoire vive","Stockage","Réseau","Requêtes","Déchets électroniques","Consommation électrique","Émissions de gaz à effet de serre"]},{"l":"Données annexes","p":["Obligatoires","trigramme: Nom court du référentiel (ex: RWEB, RWP, etc.)","currentVersion: la version en cours. Utilisée dans le header et pour pré-remplir le champ version/RefID d'une fiche (a changer avant toute session de mise à jour) ;","creationYear: année de la création du référentiel. Utilisé dans le footer creationYear - currentYear;","refTitles[lang].short: utilisés dans le header (ex: Ecoconception web ou WordPress) ;","refTitles[lang].long: utilisés dans title (par defaut) des pages (ex: Référentiel de bonnes pratiques pour l'Ecoconception web ou Référentiel de bonnes pratiques pour WordPress, Référentiel de bonnes pratiques est commun à tous les sites)."]}],[{"l":"Développer et faire évoluer"},{"l":"Stack","p":["TinaCMS 2.5.2","NextJS 14.2.14","next-plugin-preval 1.2.6","TailwindCSS 3.4.17","Fuse.js 7.0.0","Vercel","MongoDB Atlas","dependencies : mongodb-level^0.0.4","peerDependencies : mongodb^4.12.1"]},{"l":"Pourquoi TinaCMS ?","p":["TinaCMS est un CMS open source qui permet de gérer le contenu de votre site web en utilisant GitHub comme gestionnaire de contenu."]},{"l":"Pourquoi Vercel ?","p":["Vercel permet d'utiliser TinaCMS, avec Next.js, pour éditer le contenu du site online (et pas que en local) et donner des droits d'édition à des personnes qui ne sont pas développeurs."]},{"l":"Pourquoi MongoDB.com (atlas) ?","p":["TinaCMS, pour offrir la possibilité de gérer le contenu du site en ligne, nécessite un gestionnaire de base de données.","On ne peut pas monter de version en l'état... il va falloir y arriver."]},{"l":"Développer","p":["Dupliquer le fichier .env.local en .env et le remplir (demandez de l'aide)."]},{"l":"Problématiques résolues"},{"l":"Un Code, de multiple déclinaisons, le one for all","p":["Un gestionnaire de configuration à été mis en place ./referentiel-config.ts, piloté par une double variable d'environnement TINA_PUBLIC_REF_NAME et NEXT_PUBLIC_REF_NAME.","Ce gestionnaire permet de configurer, par type de référentiels, les fonctionnalitées actives.","Cela ajoute de la complexité au code, mais cela permet d'avoir une code commun qui fonctionne partout.","Un code cummun, ne veut pas dire une seule code base. Comme un référentiel = un repo, le code du générateur est dupliqué dans chaque repo. Donc chaque modification du code doit être reportée dans chaque repo."]},{"i":"code-du-gestionnaire-de-configuration","l":":icon-code: Code du gestionnaire de configuration"},{"l":"Implémentation"},{"l":"Format des fichiers MD|MDX","p":["L'utilisation de TinaCMS permet de moins se préocuper du format des fichiers de contenus.","Mais l'usage dans un IDE pour \"aller plus vite\" en édition reste tentante. Pour gérér les erreurs possible, un module de validation à été mis en place.","Il faut le lancer avant chaque commit !","A faire évoluer quand le format du contenu évolue. Source : ./content/*.schema.yaml et .remarkrc.mjs."]},{"l":"Problématiques à resoudre"},{"l":"Build localement","p":["Le build ne fonctionne que sur Vercel, ou plutôt le build de fonctionne que couplé à MongoDB Atlas comme datalayer. Une tentative infructueuse d'avoir une base MongoDB en local n'a pas résolu le problème. Le problème vient surement de next-plugin-preval utilisé par Fuse.js."]},{"l":"Bug du composant PositionableImage / ou Adv. Image","p":["Il fonctionne en front, mais fait se fermer l'éditeur de TinaCMS. Il a fonctionné, donc ce doit être un petit problème"]},{"l":"Une Stack impossible à faire évoluer","p":["Si l'on regarde la configuration des projets démo de TinaCMS, on se rend compte qu'ils sont beaucoup moins complexe que celui-ci ! Dans leurs exemples, il y une fonctionnalité qui n'est jamais impélementée : le multilingue.","Pour pouvoir profiter des dernières fonctionnalités de TinaCMS (a challenger) :","Checklist","Repartir d'une des dernières versions démo du tina-barebones-starter pour refaire la stack ;","Si possible, ne pas utiliser next-plugin-preval;","Valider que le build en local fonctionne ;","Valider que l'internationalisation fonctionne.","Créer et mettre en library un maximum de chose pour avoir une vraie code base."]}],[{"l":"Comment fonctionne le projet ?"},{"l":"Overview"},{"l":"Stack :","p":["Next.js","Tailwind CSS","TinaCMS","GitHub"]},{"l":"Hosting :","p":["Vercel","MongoDB.com (atlas)"]},{"l":"Configuration"},{"l":"Configuration de Vercel","p":["MONGODB_URI: URI de la base de données MongoDB.","GITHUB_PERSONAL_ACCESS_TOKEN: Token GitHub pour accéder au dépôt.","TINA_PUBLIC_REF_NAME: Nom du type de référentiel géré par TinaCMS (cela active certaines features ou liste de valeurs) RWEB, RWP, REF_HOME(pour le moment).","NEXT_PUBLIC_REPO_URL: URL du dépôt GitHub.","TINA_PUBLIC_IS_LOCAL: false","NEXTAUTH_SECRET: Clé secrète pour NextAuth (run openssl rand -hex 16 pour générer une clé)."]},{"l":"Configuration de MongoDB.com (atlas)","p":["Rien de spécifique, mails il faut bien activer Vercel comme intégration pour que les échanges entre Vercel et MongoDB.com (atlas) fonctionnent. https://vercel.com/<organisation|cnumr-greenit>/~/integrations/marketplace."]},{"l":"Configuration de GitHub","p":["Juste créer un token GitHub pour accéder au dépôt.","Créez un nouveau jeton d'accès personnel GitHub (PAT) avec content access pour le dépôt et copiez le jeton comme valeur pour la variable d'environnement GITHUB_PERSONAL_ACCESS_TOKEN. Mettre cette configuration dans Vercel."]}],[{"l":"Informations"},{"l":"Contributeurs","p":["Design et UX:","Florine Sueur florinesueur","Dévelopeurs:","Renaud Héluin hrenaud","Jean-Philippe Kha hrenaud"]},{"l":"Contacts","p":["contact@greenit.eco"]}]]