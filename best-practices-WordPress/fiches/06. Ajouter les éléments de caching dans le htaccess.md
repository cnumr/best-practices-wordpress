---
title: 06. Ajouter les √©l√©ments de caching dans le .htaccess
people: Dominique N.
scope: Cache
state_validation: Doing
responsible: 
  - Code(use¬∑ur) ‚Üí D√©veloppeu¬∑se¬∑r
lifecycle: Mise en ligne
priority_implementation: Fort üëçüëçüëç
environmental_impact: Fort üå±üå±üå±
saved_resources: 
 - Processeur
 - M√©moire vive
 - Stockage
 - R√©seau
 - Requ√™tes
path: /fiches/06-ajouter-les-elements-de-caching-dans-le-htaccess
toIndex: true
---

## Sujet

La fiche [12. Utiliser un syst√®me Cache](./12.%20Utiliser%20un%20syst%C3%A8me%20Cache.md) nous parle de l'importance du [[cache]] et de sa mise en place via des [[extension|extensions]] WordPress.

## GreenIT vous conseille

### Solution code üå±üå±üå±

Nous allons directement indiquer au serveur Apache les param√©trages de [[compression]] et de contr√¥le du cache que nous souhaitons.

## Exemple

Prenons pour exemple l'image du logo qui se trouve sur chaque page du site. Si nous ne mettons pas en place de cache, le navigateur la transf√©rera depuis notre serveur √† chaque affichage d'une nouvelle page.

Maintenant, compressons notre image (gzip), elle est d√©j√† plus rapide √† charger (bien s√ªr, nous partons du principe qu'elle est bien dimensionn√©e, et au bon format. cf fiches #[22. Utiliser une version d'image ayant taille coh√©rente avec son utilisation](./22.utiliser-une-version-d-image-ayant-taille-coh√©rente-avec-son-utilisation.md) & #[23. Le poids des images](./23.%20Le%20poids%20des%20images.md)).

Ensuite, indiquons que nous souhaitons qu'elle soit mise en cache pendant 1 an.
Lors de sa premi√®re visite, le logo est transf√©r√© pour l'afficher dans le navigateur. Le visiteur change de page, le navigateur regarde si l'image existe d√©j√† dans ses fichiers mis en cache : oui, alors il ne va pas la chercher sur le serveur.

> ‚ö†Ô∏è Attention, toucher au fichier .htaccess peut provoquer des erreurs, sauvegardez et testez.

```apacheconf
<IfModule mod_expires.c>
ExpiresActive On
ExpiresDefault "access plus 1 month"
#D√©lai de cache des fonts
ExpiresByType application/x-font-ttf "access plus 1 month"
[...]
#D√©lai de cache des Images
ExpiresByType image/jpg "access plus 1 month"
[...]
#D√©lai de cache des Autres m√©dias
ExpiresByType video/ogg "access plus 1 month"
[...]
#D√©lai de cache des Assets
ExpiresByType text/css "access plus 6 month"
ExpiresByType application/javascript "access plus 6 month"
</IfModule>

# En-t√™tes
Header unset ETag
FileETag None

<ifModule mod_headers.c>
<filesMatch "\.(ico|jpe?g|png|gif)$">
    Header set Cache-Control "public"
</filesMatch>
<filesMatch "\.(css)$">
    Header set Cache-Control "public"
</filesMatch>
<filesMatch "\.(js)$">
    Header set Cache-Control "private"
</filesMatch>
<filesMatch "\.(x?html?|php)$">
    Header set Cache-Control "private, must-revalidate"
</filesMatch>
</ifModule>

# Compressions des fichiers statiques
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/xhtml text/html text/plain text/xml text/javascript application/x-javascript text/css
    BrowserMatch ^Mozilla/4 gzip-only-text/html
    BrowserMatch ^Mozilla/4\.0[678] no-gzip
    BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
    SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary
    Header append Vary User-Agent env=!dont-vary
</IfModule>

AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE font/opentype
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/json
```

## Principe de validation

| Le nombre | est inf√©rieur ou √©gal √† |
| ------------- | :---------------------: |
| d'√©lements durables non mis en cache        |            0            |

## Source

- <https://www.seomix.fr/guide-htaccess-performances-et-temps-de-chargement/>
